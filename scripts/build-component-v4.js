#!/usr/bin/env node
/**
 * Build script for component-v4.css
 *
 * This creates a stylesheet for individual components that includes:
 * - @theme colors (with --color- prefix) but NO :root section
 * - @font-face declarations
 * - @theme typography variables
 * - @import 'tailwindcss'
 *
 * Components import this instead of main-v4.css to avoid duplicating
 * the :root color definitions (which are already in TailwindElement base class).
 */

import { readFileSync, writeFileSync } from 'node:fs'
import { dirname } from 'node:path'
import { fileURLToPath } from 'node:url'

const __dirname = dirname(fileURLToPath(import.meta.url))
const rootDir = dirname(__dirname)

console.log('Building component-v4.css...')

// Read generated files
const colorsV4Css = readFileSync(
  `${rootDir}/src/shared/styles/generated/colors-v4.css`,
  'utf-8'
)
const fontsV4Css = readFileSync(
  `${rootDir}/src/shared/styles/generated/fonts-v4.css`,
  'utf-8'
)

// Read the template to get the typography @theme section
const mainV4Template = readFileSync(
  `${rootDir}/src/shared/styles/main-v4.template.css`,
  'utf-8'
)

// Assemble component-v4.css (same as main-v4 but WITHOUT :root section)
// Note: @source directive should be added in each component's style.css for optimization
const componentV4Css = `/**
 * @file Component styles (Tailwind CSS v4)
 *
 * This stylesheet is for individual web components.
 * It includes @theme variables and fonts but NO :root section.
 * The :root colors are defined once in TailwindElement base class (main-v4.css).
 *
 * Components should add @source directive before importing this file:
 * @source './index.ts';
 * @import '../../shared/styles/generated/component-v4.css';
 *
 * DO NOT MODIFY MANUALLY - Generated by scripts/build-component-v4.js
 */

${colorsV4Css}

${fontsV4Css}

${mainV4Template}
@import 'tailwindcss';
`

// Write the output file
const output = `${rootDir}/src/shared/styles/generated/component-v4.css`
writeFileSync(output, componentV4Css)

console.log('âœ“ component-v4.css built successfully')
